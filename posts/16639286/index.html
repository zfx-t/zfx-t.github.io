<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>docker,nginx,sslæœ€ä½³å®è·µ | å°è´ºåŒå­¦çš„blog</title><meta name="author" content="å°è´ºåŒå­¦"><meta name="copyright" content="å°è´ºåŒå­¦"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="åŸºäºæˆ‘å¯¹dockerï¼Œnginxè¿˜æœ‰sslè¯ä¹¦çš„éƒ¨ç½²ï¼Œæå‡ºäº†æˆ‘å¯¹è¿™äº›æœåŠ¡æœ€é«˜æ•ˆçš„éƒ¨ç½²æ–¹æ³•ã€‚ä»…ä¾›å‚è€ƒï¼Œä¸€å®šä¼šæœ‰æ›´å¥½çš„æ–¹æ³•ï¼Œåªæ˜¯æˆ‘è¿˜æœ‰å¾…å­¦ä¹   ä½¿ç”¨dockeréƒ¨ç½²nginxdockeréƒ¨ç½²nginxæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿå¤§æ¦‚å°±æ˜¯å¯ä»¥æŠŠæ‰€æœ‰ç›¸å…³çš„é…ç½®æ–‡ä»¶æ±‡é›†åœ¨ä¸€å—ï¼Œä¹Ÿæ–¹ä¾¿åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸­è¿ç§»ã€‚è¿™é‡Œæä¾›éƒ¨ç½²æ‰€ä½¿ç”¨çš„dockerä»£ç ï¼š 1234567891011# å…ˆåˆ›å»ºä¸€ä¸ªnginxç½‘ç»œdocker netw">
<meta property="og:type" content="article">
<meta property="og:title" content="docker,nginx,sslæœ€ä½³å®è·µ">
<meta property="og:url" content="https://zfxt.top/posts/16639286/index.html">
<meta property="og:site_name" content="å°è´ºåŒå­¦çš„blog">
<meta property="og:description" content="åŸºäºæˆ‘å¯¹dockerï¼Œnginxè¿˜æœ‰sslè¯ä¹¦çš„éƒ¨ç½²ï¼Œæå‡ºäº†æˆ‘å¯¹è¿™äº›æœåŠ¡æœ€é«˜æ•ˆçš„éƒ¨ç½²æ–¹æ³•ã€‚ä»…ä¾›å‚è€ƒï¼Œä¸€å®šä¼šæœ‰æ›´å¥½çš„æ–¹æ³•ï¼Œåªæ˜¯æˆ‘è¿˜æœ‰å¾…å­¦ä¹   ä½¿ç”¨dockeréƒ¨ç½²nginxdockeréƒ¨ç½²nginxæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿå¤§æ¦‚å°±æ˜¯å¯ä»¥æŠŠæ‰€æœ‰ç›¸å…³çš„é…ç½®æ–‡ä»¶æ±‡é›†åœ¨ä¸€å—ï¼Œä¹Ÿæ–¹ä¾¿åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸­è¿ç§»ã€‚è¿™é‡Œæä¾›éƒ¨ç½²æ‰€ä½¿ç”¨çš„dockerä»£ç ï¼š 1234567891011# å…ˆåˆ›å»ºä¸€ä¸ªnginxç½‘ç»œdocker netw">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://image.zfxt.top/hexo-blog/docker-nginx-ssl%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-2024-12-25-16-58-02.png">
<meta property="article:published_time" content="2024-12-25T06:12:29.000Z">
<meta property="article:modified_time" content="2024-12-26T05:53:25.001Z">
<meta property="article:author" content="å°è´ºåŒå­¦">
<meta property="article:tag" content="nginx">
<meta property="article:tag" content="ssl">
<meta property="article:tag" content="è¿ç»´">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://image.zfxt.top/hexo-blog/docker-nginx-ssl%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-2024-12-25-16-58-02.png"><link rel="shortcut icon" href="https://image.zfxt.top/hexo-blog/avator.jpg"><link rel="canonical" href="https://zfxt.top/posts/16639286/index.html"><link rel="preconnect" href="//unpkg.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://unpkg.com/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://unpkg.com/@fancyapps/ui/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')
          
          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"æœªæ‰¾åˆ°ç¬¦åˆæ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}","hits_stats":"å…±æ‰¾åˆ° ${hits} ç¯‡æ–‡ç« "}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç®€"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://unpkg.com/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'docker,nginx,sslæœ€ä½³å®è·µ',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://image.zfxt.top/hexo-blog/avator.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">265</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">100</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">16</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://image.zfxt.top/hexo-blog/docker-nginx-sslæœ€ä½³å®è·µ-2024-12-25-16-58-02.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">å°è´ºåŒå­¦çš„blog</span></a><a class="nav-page-title" href="/"><span class="site-name">docker,nginx,sslæœ€ä½³å®è·µ</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">docker,nginx,sslæœ€ä½³å®è·µ</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2024-12-25T06:12:29.000Z" title="å‘è¡¨äº 2024-12-25 14:12:29">2024-12-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2024-12-26T05:53:25.001Z" title="æ›´æ–°äº 2024-12-26 13:53:25">2024-12-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/">æœ€ä½³å®è·µ</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">æ€»å­—æ•°:</span><span class="word-count">2.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>8åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><blockquote>
<p>åŸºäºæˆ‘å¯¹dockerï¼Œnginxè¿˜æœ‰sslè¯ä¹¦çš„éƒ¨ç½²ï¼Œæå‡ºäº†æˆ‘å¯¹è¿™äº›æœåŠ¡æœ€é«˜æ•ˆçš„éƒ¨ç½²æ–¹æ³•ã€‚ä»…ä¾›å‚è€ƒï¼Œä¸€å®šä¼šæœ‰æ›´å¥½çš„æ–¹æ³•ï¼Œåªæ˜¯æˆ‘è¿˜æœ‰å¾…å­¦ä¹ </p>
</blockquote>
<h1 id="ä½¿ç”¨dockeréƒ¨ç½²nginx"><a href="#ä½¿ç”¨dockeréƒ¨ç½²nginx" class="headerlink" title="ä½¿ç”¨dockeréƒ¨ç½²nginx"></a>ä½¿ç”¨dockeréƒ¨ç½²nginx</h1><p>dockeréƒ¨ç½²nginxæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿå¤§æ¦‚å°±æ˜¯å¯ä»¥æŠŠæ‰€æœ‰ç›¸å…³çš„é…ç½®æ–‡ä»¶æ±‡é›†åœ¨ä¸€å—ï¼Œä¹Ÿæ–¹ä¾¿åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸­è¿ç§»ã€‚<br>è¿™é‡Œæä¾›éƒ¨ç½²æ‰€ä½¿ç”¨çš„dockerä»£ç ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å…ˆåˆ›å»ºä¸€ä¸ªnginxç½‘ç»œ</span></span><br><span class="line">docker network create nginx_container</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿è¡Œnginxå¹¶æ·»åŠ åˆ°è¯¥ç½‘ç»œä¸­</span></span><br><span class="line">docker run --name=nginx  \</span><br><span class="line">--volume=/home/&#123;user&#125;/&#123;your_path&#125;/nginx/logs:/var/log/nginx \</span><br><span class="line">--volume=/home/&#123;user&#125;/&#123;your_path&#125;/nginx/html:/etc/nginx/html \</span><br><span class="line">--volume=/home/&#123;user&#125;/&#123;your_path&#125;/nginx/ssl:/etc/nginx/ssl \</span><br><span class="line">--volume=/home/&#123;user&#125;/&#123;your_path&#125;/nginx/nginx.conf:/etc/nginx/nginx.conf \</span><br><span class="line">--volume=/home/&#123;user&#125;/&#123;your_path&#125;/nginx/conf.d:/etc/nginx/conf.d \</span><br><span class="line">--network=nginx_container -p 443:443 -p 80:80 --restart=always --runtime=runc --detach=true nginx nginx -g &#x27;daemon off;&#x27;</span><br></pre></td></tr></table></figure>

<p>åœ¨ä¸Šè¿°å‘½ä»¤ä¸­ï¼Œæœ€å…³é”®çš„å†…å®¹æœ‰4ç‚¹ï¼š</p>
<h2 id="æœ¬åœ°ç›®å½•æ˜ å°„"><a href="#æœ¬åœ°ç›®å½•æ˜ å°„" class="headerlink" title="æœ¬åœ°ç›®å½•æ˜ å°„"></a>æœ¬åœ°ç›®å½•æ˜ å°„</h2><p>æˆ‘ä¸€å…±æ˜ å°„äº†4ä¸ªç›®å½•å’Œä¸€ä¸ªé…ç½®æ–‡ä»¶(è¿™äº›ç›®å½•å’Œé…ç½®æ–‡ä»¶éœ€è¦ä½ æå‰åˆ›å»ºå¥½ï¼Œæ–¹ä¾¿dockerå¯¹å…¶æ˜ å°„)</p>
<ul>
<li><p>logs<br>  è¯¥ç›®å½•ä¸‹ä¸»è¦ä¿å­˜ç€æ¯æ¬¡è®¿é—®ç½‘ç«™æ—¶ä¿å­˜çš„æ—¥å¿—è®°å½•ï¼Œå¯ä»¥ç”¨æ¥æŸ¥è¯¢ç›¸å…³çš„è®¿é—®è®°å½•å’Œdebug<br>  <img src="https://image.zfxt.top/hexo-blog/docker-nginx-ssl%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-2024-12-25-15-02-58.png" alt="docker-nginx-sslæœ€ä½³å®è·µ-2024-12-25-15-02-58"></p>
</li>
<li><p>html<br>  è¿™é‡Œå°±æ˜¯ä½ æ‰€ä½¿ç”¨çš„é™æ€æ–‡ä»¶äº†ã€‚åŒæ ·æ˜ å°„åˆ°äº†dockerä¸‹çš„<code>/etc/nginx/html</code>è¿™ä¸ªéƒ¨åˆ†çš„å†…å®¹å³é»˜è®¤çš„rootæ ¹ç›®å½•ã€‚å¯ä»¥å¾ˆæ–¹ä¾¿çš„å¯¹ä¸åŒçš„é¡¹ç›®è¿›è¡Œåå‘ä»£ç†ï¼Œè€Œä¸”åªç”¨å¡«ç›¸å¯¹è·¯å¾„</p>
</li>
<li><p>ssl<br>  æ­¤å¤„æ”¾ä½ éœ€è¦é…ç½®çš„sslè¯ä¹¦ï¼Œåç»­æˆ‘ä¼šè¯´å¦‚ä½•é…ç½®<code>freessl</code>å®ç°æ°¸ä¹…çš„è¯ä¹¦è‡ªåŠ¨é…ç½®åŠŸèƒ½</p>
</li>
<li><p>conf.d<br>  è¿™ä¸ªç›®å½•å­˜æ”¾ä½ å¯¹ä¸åŒé¡¹ç›®çš„ä¸åŒé…ç½®æ–‡ä»¶ï¼Œåšåˆ°æ¯ä¸ªé¡¹ç›®éƒ½åˆ†å¼€å­˜æ”¾ï¼Œç»“æ„æ¸…æ™°ã€‚</p>
</li>
<li><p>nginx.conf<br>  è¿™é‡Œæ˜¯ä½¿ç”¨é»˜è®¤çš„é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä¼šæä¾›æ¨¡æ¿ï¼š</p>
  <figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">user</span> www-data;</span><br><span class="line"><span class="attribute">worker_processes</span> auto;</span><br><span class="line"><span class="attribute">pid</span> /run/nginx.pid;</span><br><span class="line"><span class="attribute">include</span> /etc/nginx/modules-enabled/<span class="regexp">*.conf</span>;</span><br><span class="line"><span class="section">events</span> &#123;</span><br><span class="line">        <span class="attribute">worker_connections</span> <span class="number">768</span>;</span><br><span class="line">        <span class="comment"># multi_accept on;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">http</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">##</span></span><br><span class="line">        <span class="comment"># Basic Settings</span></span><br><span class="line">        <span class="comment">##</span></span><br><span class="line">        <span class="attribute">sendfile</span> <span class="literal">on</span>;</span><br><span class="line">        <span class="attribute">tcp_nopush</span> <span class="literal">on</span>;</span><br><span class="line">        <span class="attribute">tcp_nodelay</span> <span class="literal">on</span>;</span><br><span class="line">        <span class="attribute">keepalive_timeout</span> <span class="number">65</span>;</span><br><span class="line">        <span class="attribute">types_hash_max_size</span> <span class="number">2048</span>;</span><br><span class="line">        <span class="comment"># server_tokens off;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># server_names_hash_bucket_size 64;</span></span><br><span class="line">        <span class="comment"># server_name_in_redirect off;</span></span><br><span class="line">        <span class="attribute">include</span> /etc/nginx/mime.types;</span><br><span class="line">        <span class="attribute">default_type</span> application/octet-stream;</span><br><span class="line"></span><br><span class="line">        <span class="comment">##</span></span><br><span class="line">        <span class="comment"># SSL Settings</span></span><br><span class="line">        <span class="comment">##</span></span><br><span class="line"></span><br><span class="line">        <span class="attribute">ssl_protocols</span> TLSv1 TLSv1.<span class="number">1</span> TLSv1.<span class="number">2</span> TLSv1.<span class="number">3</span>; <span class="comment"># Dropping SSLv3, ref: POODLE</span></span><br><span class="line">        <span class="attribute">ssl_prefer_server_ciphers</span> <span class="literal">on</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">##</span></span><br><span class="line">        <span class="comment"># Logging Settings</span></span><br><span class="line">        <span class="comment">##</span></span><br><span class="line"></span><br><span class="line">        <span class="attribute">access_log</span> /var/log/nginx/access.log;</span><br><span class="line">        <span class="attribute">error_log</span> /var/log/nginx/<span class="literal">error</span>.log;</span><br><span class="line"></span><br><span class="line">        <span class="comment">##</span></span><br><span class="line">        <span class="comment"># Gzip Settings</span></span><br><span class="line">        <span class="comment">##</span></span><br><span class="line"></span><br><span class="line">        <span class="attribute">gzip</span> <span class="literal">on</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># gzip_vary on;</span></span><br><span class="line">        <span class="comment"># gzip_proxied any;</span></span><br><span class="line">        <span class="comment"># gzip_comp_level 6;</span></span><br><span class="line">        <span class="comment"># gzip_buffers 16 8k;</span></span><br><span class="line">        <span class="comment"># gzip_http_version 1.1;</span></span><br><span class="line">        <span class="comment"># gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">##</span></span><br><span class="line">        <span class="comment"># Virtual Host Configs</span></span><br><span class="line">        <span class="comment">##</span></span><br><span class="line">        <span class="comment"># è¿™é‡Œå°†ä¼šå¼•ç”¨ä½ åœ¨conf.dä¸‹çš„æ‰€æœ‰é…ç½®æ–‡ä»¶ã€‚æ‰€ä»¥è¿™ä¸ªnginx.confæ–‡ä»¶ä½ éƒ½ä¸ç”¨ç¼–è¾‘</span></span><br><span class="line">        <span class="attribute">include</span> /etc/nginx/conf.d/<span class="regexp">*.conf</span>;</span><br><span class="line">        <span class="attribute">include</span> /etc/nginx/sites-enabled/*;</span><br><span class="line">        <span class="attribute">include</span> /etc/nginx/conf.d/**/<span class="regexp">*.conf</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#test_3d</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#mail &#123;</span></span><br><span class="line"><span class="comment">#       # See sample authentication script at:</span></span><br><span class="line"><span class="comment">#       # http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#       # auth_http localhost/auth.php;</span></span><br><span class="line"><span class="comment">#       # pop3_capabilities &quot;TOP&quot; &quot;USER&quot;;</span></span><br><span class="line"><span class="comment">#       # imap_capabilities &quot;IMAP4rev1&quot; &quot;UIDPLUS&quot;;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#       server &#123;</span></span><br><span class="line"><span class="comment">#               listen     localhost:110;</span></span><br><span class="line"><span class="comment">#               protocol   pop3;</span></span><br><span class="line"><span class="comment">#               proxy      on;</span></span><br><span class="line"><span class="comment">#       &#125;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#       server &#123;</span></span><br><span class="line"><span class="comment">#               listen     localhost:143;</span></span><br><span class="line"><span class="comment">#               protocol   imap;</span></span><br><span class="line"><span class="comment">#               proxy      on;</span></span><br><span class="line"><span class="comment">#       &#125;</span></span><br><span class="line"><span class="comment">#&#125;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="é…ç½®ä¸“é—¨çš„nginxç½‘ç»œ"><a href="#é…ç½®ä¸“é—¨çš„nginxç½‘ç»œ" class="headerlink" title="é…ç½®ä¸“é—¨çš„nginxç½‘ç»œ"></a>é…ç½®ä¸“é—¨çš„nginxç½‘ç»œ</h2><p>å¯ä»¥çœ‹åˆ°æˆ‘åœ¨ä¸Šé¢çš„dockerå‘½ä»¤ä¸­ï¼Œæœ‰ä¸€ä¸ª<code>--network=nginx_container</code>çš„é€‰é¡¹ã€‚</p>
<p>ä½¿ç”¨<code>docker network inspect nginx_container</code>å‘½ä»¤æŸ¥çœ‹<br><img src="https://image.zfxt.top/hexo-blog/docker-nginx-ssl%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-2024-12-25-15-11-21.png" alt="docker-nginx-sslæœ€ä½³å®è·µ-2024-12-25-15-11-21"><br>å¦‚ä½•å°†å…¶ä»–å®¹å™¨æ·»åŠ åˆ°æŸä¸ªç½‘ç»œä¸­ï¼Ÿ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸€ï¼Œåœ¨å¯åŠ¨å®¹å™¨æ—¶å°±ä½¿ç”¨--networkçš„é€‰é¡¹å°±æ·»åŠ åˆ°æŸä¸ªç½‘ç»œä¸­å»</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">äºŒï¼Œä½¿ç”¨ä¸‹é¢è¿™æ¡å‘½ä»¤</span></span><br><span class="line">docker network connect &#123;network_name&#125; &#123;container_name&#125;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¾‹å¦‚ docker network connect nginx_container alist</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨å›¾ç¤ºæ¥å±•ç¤ºå…³äºè¿™ä¸€æ“ä½œçš„å¦™ç”¨ï¼š<br><img src="https://image.zfxt.top/hexo-blog/docker-nginx-ssl%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-2024-12-25-15-28-17.png" alt="docker-nginx-sslæœ€ä½³å®è·µ-2024-12-25-15-28-17"><br>è¿™æ ·å­ï¼Œå…¶ä»–çš„æœåŠ¡ä¸å ç”¨ä¸»æœºçš„å¤–éƒ¨ç«¯å£ï¼Œè€Œåªä¾é nginxä»£ç†å‡ºå»ã€‚ä¿è¯äº†æœåŠ¡çš„å®‰å…¨ï¼Œä¹Ÿå‡å°‘äº†ç«¯å£è¢«æ‰«ï¼Œè¢«æ”»å‡»çš„é£é™©ã€‚</p>
<p>åŒæ—¶ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œä¹Ÿä¼šæœ‰å¾ˆæ–¹ä¾¿çš„åœ°æ–¹ã€‚è¿™é‡Œå±•ç¤º<code>alist.conf</code><br><img src="https://image.zfxt.top/hexo-blog/docker-nginx-ssl%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-2024-12-25-15-34-27.png" alt="docker-nginx-sslæœ€ä½³å®è·µ-2024-12-25-15-34-27">æˆ‘ä»¬ä¸åœ¨éœ€è¦å†™å®Œæ•´çš„æœåŠ¡å™¨ipåœ°å€ï¼Œè€Œæ˜¯é€šè¿‡<code>http://alist</code>çš„æ–¹å¼è‡ªåŠ¨å»è®¿é—®ï¼Œå³ä¾¿æœåŠ¡å™¨è¢«é‡å¯ï¼Œä»–åˆ†é…åœ¨ä¸åŒçš„ipã€‚ä¹Ÿå¯ä»¥å®ç°å¯¹åº”çš„è®¿é—®åŠŸèƒ½ã€‚</p>
<p>è¿˜æœ‰æ›´å¤šå…³äºnginxç½‘ç»œçš„éƒ¨åˆ†å¯ä»¥æŸ¥çœ‹è¿™ä¸€æ–‡ç« <a href="https://zfxt.top/posts/f491796a/">dockerç½‘ç»œæ¨¡å¼</a></p>
<h2 id="è®¾ç½®ä¸€ç›´é‡å¯"><a href="#è®¾ç½®ä¸€ç›´é‡å¯" class="headerlink" title="è®¾ç½®ä¸€ç›´é‡å¯"></a>è®¾ç½®ä¸€ç›´é‡å¯</h2><p>è¿™é‡Œå°±æ˜¯ç®€å•çš„å‚æ•°é…ç½®<br><code>--restart=always</code><br>å³ä½¿æœåŠ¡å™¨å› ä¸ºæ–­ç”µç­‰åŸå› é‡å¯ï¼Œä¹Ÿå¯ä»¥åœ¨é€šç”µåé‡æ–°æ¢å¤æœåŠ¡ã€‚</p>
<h1 id="ä¸ºnginxé…ç½®sslè¯ä¹¦"><a href="#ä¸ºnginxé…ç½®sslè¯ä¹¦" class="headerlink" title="ä¸ºnginxé…ç½®sslè¯ä¹¦"></a>ä¸ºnginxé…ç½®sslè¯ä¹¦</h1><p>é…ç½®sslè¯ä¹¦å…¶å®æ˜¯æ¯”è¾ƒç®€å•çš„äº‹ã€‚<br>ä½ å¯ä»¥ä»é˜¿é‡Œäº‘ï¼Œè…¾è®¯äº‘å…è´¹é¢†å–åˆ°æ—¶é•¿1å¹´çš„å•åŸŸåè¯ä¹¦ï¼Œç„¶ååœ¨confé…ç½®ä¸­å¼€å¯sslæ ¡éªŒå¹¶é…ç½®sslè¯ä¹¦å’Œå¯†é’¥çš„åœ°å€å³å¯ã€‚</p>
<p>æˆ‘è¿™é‡Œä¸»è¦æ˜¯ä¸ºäº†å®ç°æ³›åŸŸåçš„æ°¸ä¹…æ€§é…ç½®ã€‚<br><a target="_blank" rel="noopener" href="https://freessl.cn/automation/auth">freessl</a>è¿™æ˜¯æˆ‘æœ€å¸¸ç”¨çš„sslè¯ä¹¦é…ç½®æœåŠ¡ã€‚ä»–æä¾›3ä¸ªæœˆæ—¶é•¿çš„å…è´¹æ³›åŸŸåã€‚ç„¶åé€šè¿‡ä¸€äº›é…ç½®å®ç°åˆ°æœŸè‡ªåŠ¨æ›´æ–°éƒ¨ç½²æ–°çš„è¯ä¹¦ï¼Œåšåˆ°æ°¸ä¹…æœ‰æ•ˆã€‚</p>
<blockquote>
<p>ä»–æœ‰æ–°ç‰ˆå’Œæ—§ç‰ˆä¹‹åŒºåˆ†ï¼Œæˆ‘è¿™é‡Œæ¼”ç¤ºæ—§ç‰ˆçš„åŠŸèƒ½ã€‚æ–°ç‰ˆå°±æ˜¯æ›¿ä½ å®ç°dnsæœåŠ¡å™¨çš„é…ç½®è¿‡ç¨‹ã€‚éƒ½æ˜¯å¾ˆå¥½çš„æœåŠ¡ã€‚(åªæ˜¯æˆ‘æ‡’å¾—æäº†ã€‚å°±ç”¨æ—§ç‰ˆæ¼”ç¤ºçœ‹çœ‹å°±å¥½å•¦)</p>
</blockquote>
<h2 id="æ·»åŠ åŸŸå"><a href="#æ·»åŠ åŸŸå" class="headerlink" title="æ·»åŠ åŸŸå"></a>æ·»åŠ åŸŸå</h2><p><img src="https://image.zfxt.top/hexo-blog/docker-nginx-ssl%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-2024-12-25-16-02-00.png" alt="docker-nginx-sslæœ€ä½³å®è·µ-2024-12-25-16-02-00"><br>æ·»åŠ åŸŸåå¯ä»¥ä½¿ç”¨æ³›åŸŸåå’Œå•åŸŸåã€‚æ·»åŠ åŸŸååï¼Œéœ€è¦ä½ è¯æ˜è¿™ä¸ªåŸŸåæ˜¯åœ¨ä½ çš„åä¸‹ï¼Œè€Œä¸”ä½ å¯¹ä»–æœ‰æ§åˆ¶æƒã€‚å³åœ¨å¯¹åº”çš„dnsæœåŠ¡å•†æ·»åŠ ä¸Šä»–è¦æ±‚ä½ æ·»åŠ çš„é…ç½®é¡¹</p>
<blockquote>
<p>æ–°ç‰ˆå°±æ˜¯è¿™é‡Œä¸éœ€è¦ä½ è¿›è¡ŒéªŒè¯ï¼Œè€Œæ˜¯æŠŠéªŒè¯è¿‡ç¨‹äº¤ç»™ç³»ç»Ÿå»å®ç°ï¼Œä½ åªéœ€è¦æä¾›å‡ ä¸ªtokenã€‚</p>
</blockquote>
<p><img src="https://image.zfxt.top/hexo-blog/docker-nginx-ssl%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-2024-12-25-16-03-20.png" alt="docker-nginx-sslæœ€ä½³å®è·µ-2024-12-25-16-03-20"></p>
<p>é€šè¿‡æ·»åŠ CNAMEéªŒè¯ï¼Œè¿‡ä¸€å°æ®µæ—¶é—´åï¼Œä»–å°±ä¼šæ ¡éªŒæˆåŠŸã€‚<br><img src="https://image.zfxt.top/hexo-blog/docker-nginx-ssl%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-2024-12-25-16-11-54.png" alt="docker-nginx-sslæœ€ä½³å®è·µ-2024-12-25-16-11-54"><br><img src="https://image.zfxt.top/hexo-blog/docker-nginx-ssl%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-2024-12-25-16-13-16.png" alt="docker-nginx-sslæœ€ä½³å®è·µ-2024-12-25-16-13-16"></p>
<h2 id="å°†è¯ä¹¦éƒ¨ç½²åˆ°æœåŠ¡å™¨"><a href="#å°†è¯ä¹¦éƒ¨ç½²åˆ°æœåŠ¡å™¨" class="headerlink" title="å°†è¯ä¹¦éƒ¨ç½²åˆ°æœåŠ¡å™¨"></a>å°†è¯ä¹¦éƒ¨ç½²åˆ°æœåŠ¡å™¨</h2><p>æ¥ä¸‹é‡Œä½¿ç”¨<code>acme.sh</code>å°†è¯ä¹¦éƒ¨ç½²åˆ°æœåŠ¡å™¨ã€‚</p>
<ol>
<li><p>å®‰è£…<code>acme.sh</code>å®¢æˆ·ç«¯<br> å®˜æ–¹ä¸‹è½½åœ°å€ï¼š</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://get.acme.sh | sh -s email=my@example.com</span><br></pre></td></tr></table></figure>

<p> å¤‡ç”¨ä¸‹è½½åœ°å€</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://gitcode.net/cert/cn-acme.sh/-/raw/master/install.sh?inline=false | sh -s email=my@example.com</span><br></pre></td></tr></table></figure>
</li>
<li><p>è·å–ç”³è¯·å‘½ä»¤<br> åœ¨<code>ACMEå®¢æˆ·ç«¯</code>-&gt;<code>ç”³è¯·è¯ä¹¦</code>ä¸­ï¼Œè·å–å®‰è£…å‘½ä»¤<br> <img src="https://image.zfxt.top/hexo-blog/docker-nginx-ssl%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-2024-12-25-16-18-52.png" alt="docker-nginx-sslæœ€ä½³å®è·µ-2024-12-25-16-18-52"><br> ç„¶åå°†ä½ è·å–åˆ°çš„å‘½ä»¤ç›´æ¥åœ¨æœåŠ¡å™¨ä¸­è¿è¡Œå³å¯ï¼Œç­‰å¾…ç‰‡åˆ»åï¼Œè¯ä¹¦å’Œå¯†é’¥å°±ä¼šä¿å­˜åœ¨ä½ ç”¨æˆ·ç›®å½•ä¸‹çš„<code>.acme.sh/&#123;åŸŸå&#125;</code>ä¸‹<br> <img src="https://image.zfxt.top/hexo-blog/docker-nginx-ssl%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-2024-12-25-16-23-07.png" alt="docker-nginx-sslæœ€ä½³å®è·µ-2024-12-25-16-23-07"><br> å…¶ä¸­ä½ éœ€è¦ä½¿ç”¨çš„åˆ°çš„æ˜¯<code>fullchain.cer</code>å’Œ<code>selflove.ren.key</code></p>
</li>
<li><p>å°†è¯ä¹¦å®‰è£…åˆ°å…·ä½“çš„ç›®å½•ä¸‹<br> å‘½ä»¤å¦‚ä¸‹ï¼š(ä»¥æˆ‘çš„ç›®å½•ç»“æ„ä¸ºç¤ºä¾‹)</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --install-cert -d selflove.ren \</span><br><span class="line">        --key-file       /home/zfxt/docker_data/nginx/ssl/selflove.key  \</span><br><span class="line">        --fullchain-file /home/zfxt/docker_data/nginx/ssl/selflove.cer</span><br></pre></td></tr></table></figure>

<p> å®Œæˆå®‰è£…åï¼Œä»–ä¼šæ¯å¤©æ£€æµ‹å®šæ—¶æ£€æµ‹ï¼Œè‹¥æ˜¯åŸŸåè¿˜åªå‰©ä¸‹ä¸€ä¸ªæœˆæ—¶ï¼Œä»–å°±ä¼šé‡æ–°è¿›è¡Œä¸€æ¬¡è¯ä¹¦è·å–å’Œå®‰è£…<br> å¯ä»¥ä½¿ç”¨<code>crontab -l</code>æŸ¥çœ‹ç³»ç»Ÿçš„å®šæ—¶ä»»åŠ¡ã€‚ä¼šæœ‰ä¸€ä¸ªå’Œacme.shç›¸å…³çš„ä»»åŠ¡çš„</p>
</li>
</ol>
<h2 id="ä¸ºnginxä½¿ç”¨é…ç½®æ–‡ä»¶"><a href="#ä¸ºnginxä½¿ç”¨é…ç½®æ–‡ä»¶" class="headerlink" title="ä¸ºnginxä½¿ç”¨é…ç½®æ–‡ä»¶"></a>ä¸ºnginxä½¿ç”¨é…ç½®æ–‡ä»¶</h2><p>ç›´æ¥ä½¿ç”¨æ¨¡æ¿æ–‡ä»¶åˆ°æ—¶å€™å†ä¿®æ”¹å³å¯ï¼š</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">        <span class="attribute">listen</span> <span class="number">443</span> ssl;</span><br><span class="line">        <span class="attribute">server_name</span> alist.zfxt.top;</span><br><span class="line">        <span class="comment"># ä¸‹é¢sslå¼€å¤´çš„æ˜¯HTTPSç›¸å…³çš„è®¾ç½®</span></span><br><span class="line">        <span class="attribute">ssl_certificate</span>          /etc/nginx/ssl/fullchain.cer;</span><br><span class="line">        <span class="attribute">ssl_certificate_key</span>     /etc/nginx/ssl/all.key;</span><br><span class="line">        <span class="attribute">ssl_session_timeout</span>     <span class="number">3600m</span>;<span class="comment">#sessionæœ‰æ•ˆæœŸï¼Œæ ¹æ®éœ€è¦é€‚å½“å»¶é•¿</span></span><br><span class="line">        <span class="attribute">ssl_session_cache</span>       shared:SSL:<span class="number">10m</span>;</span><br><span class="line">        <span class="comment"># ä½¿ç”¨çš„åŠ è§£å¯†æ–¹å¼</span></span><br><span class="line">        <span class="attribute">ssl_ciphers</span>             ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;</span><br><span class="line">        <span class="comment"># æ”¯æŒçš„åè®®ç±»å‹</span></span><br><span class="line">        <span class="attribute">ssl_protocols</span>             TLSv1 TLSv1.<span class="number">1</span> TLSv1.<span class="number">2</span>;</span><br><span class="line">        <span class="comment"># ä¼˜å…ˆä½¿ç”¨æœåŠ¡ç«¯çš„åŠ è§£å¯†æ–¹å¼</span></span><br><span class="line">        <span class="attribute">ssl_prefer_server_ciphers</span> <span class="literal">on</span>;</span><br><span class="line">        <span class="section">location</span> / &#123;</span><br><span class="line">          <span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">          <span class="attribute">proxy_set_header</span> X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line">          <span class="attribute">proxy_set_header</span> Host <span class="variable">$host</span>:<span class="variable">$server_port</span>;</span><br><span class="line">          <span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">          <span class="attribute">proxy_set_header</span> Range <span class="variable">$http_range</span>;</span><br><span class="line">          <span class="attribute">proxy_set_header</span> If-Range <span class="variable">$http_if_range</span>;</span><br><span class="line">          <span class="attribute">proxy_redirect</span> <span class="literal">off</span>;</span><br><span class="line">          <span class="attribute">proxy_pass</span> http://alist:5244;</span><br><span class="line">          <span class="comment"># the max size of file to upload</span></span><br><span class="line">          <span class="attribute">client_max_body_size</span> <span class="number">20000m</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨dockerä¸­çš„<code>etc/nginx/ssl</code>ç›®å½•å°±æ˜ å°„æˆ‘ä»¬åœ¨å¯¹åº”ä½ç½®çš„sslç›®å½•ã€‚å› æ­¤åªéœ€è¦åšåˆ°ä¸Šè¿°é…ç½®ã€‚å°±å·®ä¸å¤šé…ç½®å¥½äº†sslè¯ä¹¦äº†ã€‚</p>
<blockquote>
<p>ä»¥ä¸Šï¼Œæœ¬æ¬¡æ–‡ç« çš„ç›®çš„åŸºæœ¬å°±è¾¾æˆäº†ã€‚ä¸‹é¢åœ¨è¡¥å……ä¸€äº›å…³äºnginxçš„ä½¿ç”¨è¯´æ˜ã€‚</p>
</blockquote>
<h1 id="nginxä½¿ç”¨è¯´æ˜"><a href="#nginxä½¿ç”¨è¯´æ˜" class="headerlink" title="nginxä½¿ç”¨è¯´æ˜"></a>nginxä½¿ç”¨è¯´æ˜</h1><h2 id="Nginxçš„locationè¯­æ³•"><a href="#Nginxçš„locationè¯­æ³•" class="headerlink" title="Nginxçš„locationè¯­æ³•"></a>Nginxçš„locationè¯­æ³•</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">location</span> [=|~|~*|^~] /uri/ &#123; â€¦ &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>&#x3D;         ä¸¥æ ¼åŒ¹é…ã€‚å¦‚æœè¯·æ±‚åŒ¹é…è¿™ä¸ªlocationï¼Œé‚£ä¹ˆå°†åœæ­¢æœç´¢å¹¶ç«‹å³å¤„ç†æ­¤è¯·æ±‚</li>
<li>~         åŒºåˆ†å¤§å°å†™åŒ¹é…(å¯ç”¨æ­£åˆ™è¡¨è¾¾å¼)</li>
<li>~*       ä¸åŒºåˆ†å¤§å°å†™åŒ¹é…(å¯ç”¨æ­£åˆ™è¡¨è¾¾å¼)</li>
<li>!~       åŒºåˆ†å¤§å°å†™ä¸åŒ¹é…</li>
<li>!~*     ä¸åŒºåˆ†å¤§å°å†™ä¸åŒ¹é…</li>
<li>^~      å¦‚æœæŠŠè¿™ä¸ªå‰ç¼€ç”¨äºä¸€ä¸ªå¸¸è§„å­—ç¬¦ä¸²,é‚£ä¹ˆå‘Šè¯‰nginx å¦‚æœè·¯å¾„åŒ¹é…é‚£ä¹ˆä¸æµ‹è¯•æ­£åˆ™è¡¨è¾¾å¼</li>
</ul>
<h2 id="aliasä¸rootçš„åŒºåˆ«"><a href="#aliasä¸rootçš„åŒºåˆ«" class="headerlink" title="aliasä¸rootçš„åŒºåˆ«"></a>aliasä¸rootçš„åŒºåˆ«</h2><ul>
<li>root    å®é™…è®¿é—®æ–‡ä»¶è·¯å¾„ä¼šæ‹¼æ¥URLä¸­çš„è·¯å¾„</li>
<li>alias   å®é™…è®¿é—®æ–‡ä»¶è·¯å¾„ä¸ä¼šæ‹¼æ¥URLä¸­çš„è·¯å¾„</li>
</ul>
<p>ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">location</span><span class="regexp"> ^~</span> /sta/ &#123;  </span><br><span class="line">   <span class="attribute">alias</span> /usr/local/nginx/html/static/;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¯·æ±‚ï¼š<code>http://test.com/sta/sta1.html</code><br>å®é™…è®¿é—®ï¼š<code>/etc/nginx/html/static/sta1.html</code> æ–‡ä»¶</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">location</span><span class="regexp"> ^~</span> /tea/ &#123;  </span><br><span class="line">   <span class="attribute">root</span> /usr/local/nginx/html/;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¯·æ±‚ï¼š<code>http://test.com/tea/tea1.html</code><br>å®é™…è®¿é—®ï¼š<code>/etc/nginx/html/tea/tea1.html</code> æ–‡ä»¶</p>
<h2 id="proxy-passçš„ä½¿ç”¨"><a href="#proxy-passçš„ä½¿ç”¨" class="headerlink" title="proxy_passçš„ä½¿ç”¨"></a>proxy_passçš„ä½¿ç”¨</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">location</span> /api &#123;</span><br><span class="line">    <span class="attribute">proxy_pass</span>  http://api_server;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> Host <span class="variable">$host</span>;</span><br><span class="line">    <span class="attribute">proxy_set_header</span>  X-Real-IP        <span class="variable">$remote_addr</span>;</span><br><span class="line">    <span class="attribute">proxy_set_header</span>  X-Forwarded-For  <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">    <span class="attribute">proxy_set_header</span>  your-custome-header    <span class="string">&quot;myHeader&quot;</span>;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> X-NginX-Proxy <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é…ç½®åå‘ä»£ç†æ—¶ï¼Œç§»é™¤å‰ç¼€ã€‚æ¯”å¦‚æˆ‘ä»¬çš„æœåŠ¡<code>http://test.com/api/random</code>, æˆ‘ä»¬æƒ³è¦ä»£ç†åˆ°<code>http://yiyan.com/random</code>ï¼Œå³åˆ‡æ¢åŸŸåçš„åŒæ—¶ï¼Œå»æ‰apiå‰ç¼€ã€‚åŒºåˆ«æ˜¯<code>proxy_pass</code>ç»“å°¾çš„<code>/</code>.<br>æ— <code>/</code>åˆ™ä¿ç•™å‰ç¼€ï¼Œæœ‰<code>/</code>åˆ™åˆ é™¤å‰ç¼€ã€‚</p>
<h2 id="permanent-å’Œ-redirectå…³é”®å­—çš„åŒºåˆ«"><a href="#permanent-å’Œ-redirectå…³é”®å­—çš„åŒºåˆ«" class="headerlink" title="permanent å’Œ redirectå…³é”®å­—çš„åŒºåˆ«"></a>permanent å’Œ redirectå…³é”®å­—çš„åŒºåˆ«</h2><ul>
<li><code>rewrite â€¦ permanent</code>   æ°¸ä¹…æ€§é‡å®šå‘ï¼Œè¯·æ±‚æ—¥å¿—ä¸­çš„çŠ¶æ€ç ä¸º301</li>
<li><code>rewrite â€¦ redirect</code>         ä¸´æ—¶é‡å®šå‘ï¼Œè¯·æ±‚æ—¥å¿—ä¸­çš„çŠ¶æ€ç ä¸º302</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://zfxt.top">å°è´ºåŒå­¦</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://zfxt.top/posts/16639286/">https://zfxt.top/posts/16639286/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="https://zfxt.top" target="_blank">å°è´ºåŒå­¦çš„blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/nginx/">nginx</a><a class="post-meta__tags" href="/tags/ssl/">ssl</a><a class="post-meta__tags" href="/tags/%E8%BF%90%E7%BB%B4/">è¿ç»´</a></div><div class="post-share"><div class="social-share" data-image="https://image.zfxt.top/hexo-blog/docker-nginx-sslæœ€ä½³å®è·µ-2024-12-25-16-58-02.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://unpkg.com/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://unpkg.com/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/9493ce59/" title="æ–°å…¬å‘Š"><img class="cover" src="https://image.zfxt.top/hexo-blog/æ–°å…¬å‘Š-2025-02-18-15-37-55.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">ä¸Šä¸€ç¯‡</div><div class="info-item-2">æ–°å…¬å‘Š</div></div><div class="info-2"><div class="info-item-1">å¤§å®¶å¥½ï¼Œè¿™ä¸ªåšå®¢æ›´æ–°è‡³ä»Šå·²æœ‰å°†è¿‘2å¹´äº†ï¼ŒæœŸé—´ä»memosåˆ‡æ¢åˆ°typechoã€‚æœ€åè¿ç§»åˆ°hexoåšä¸ºæœ€ç»ˆçš„åšå®¢å¹³å°ã€‚è€Œåœ¨ä¹‹åï¼Œæˆ–è®¸è¿™ä¸ªåšå®¢å°†ä¼šå¤§å¤§é™ä½æ›´æ–°é¢‘ç‡äº†ã€‚ ä¸€æ˜¯å› ä¸ºæœ€è¿‘ä¸Šæ‰‹äº†æ–°çš„ç¬”è®°å¹³å°Obsidian,å†æ­é…ä¸Šä¸€äº›å…¶ä»–çš„äº‘å­˜å‚¨å·¥å…·ã€‚ä»–å·²ç»å¯ä»¥åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šèƒœä»»æˆ‘å¯¹çŸ¥è¯†è®°å½•çš„éœ€æ±‚ã€‚æ‰€ä»¥å¾€åæˆ‘å¯èƒ½å°‘å†åšå®¢ä¸Šæ›´æ–°äº†ã€‚è€Œæ˜¯ç›´æ¥è®°å½•åœ¨æˆ‘çš„ä¸ªäººç¬”è®°ä¸Šã€‚å…¶æ¬¡ï¼Œæ¥ä¸‹æ¥ä¹Ÿå³å°†æ­¥å…¥ç¤¾ä¼šï¼Œè¦é¢ä¸´å·¥ä½œäº†ï¼Œæˆ–è®¸ä¹Ÿä¸ä¼šæœ‰å¤ªå……è¶³çš„æ—¶é—´è®©æˆ‘å¹¿è€Œå­¦ä¹‹ç„¶åæ›´æ–°åšå®¢å†…å®¹ã€‚ å½“ç„¶å†æ­¤ä¹‹åï¼Œæˆ‘è‚¯å®šä¹Ÿä¼šæ›´æ–°ï¼Œåªæ˜¯å†…å®¹ä¼šæ›´åŠ ç²¾ç‚¼ï¼Œå°½é‡åšåˆ°æ¯ä¸€æ¬¡çš„å†…å®¹éƒ½æ›´åŠ æœ‰ä»·å€¼ğŸ˜˜ğŸ˜˜ğŸ˜˜ ä»¥ä¸Š </div></div></div></a><a class="pagination-related" href="/posts/f5d3f52f/" title="ä½¿ç”¨gitea actionå®ç°CICD"><img class="cover" src="https://image.zfxt.top/hexo-blog/ä½¿ç”¨gitea-actionå®ç°CICD-2024-12-25-14-13-21.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">ä½¿ç”¨gitea actionå®ç°CICD</div></div><div class="info-2"><div class="info-item-1">CICDCI&#x2F;CD æ˜¯æŒç»­é›†æˆå’ŒæŒç»­äº¤ä»˜&#x2F;éƒ¨ç½²çš„ç¼©å†™ï¼Œæ—¨åœ¨ç®€åŒ–å¹¶åŠ å¿«è½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸã€‚ æŒç»­é›†æˆï¼ˆCIï¼‰æ˜¯æŒ‡è‡ªåŠ¨ä¸”é¢‘ç¹åœ°å°†ä»£ç æ›´æ”¹é›†æˆåˆ°å…±äº«æºä»£ç å­˜å‚¨åº“ä¸­çš„åšæ³•ã€‚æŒç»­äº¤ä»˜å’Œ&#x2F;æˆ–æŒç»­éƒ¨ç½²ï¼ˆCDï¼‰æ˜¯ä¸€ä¸ªç”±ä¸¤éƒ¨åˆ†ç»„æˆçš„è¿‡ç¨‹ï¼Œæ¶‰åŠä»£ç æ›´æ”¹çš„é›†æˆã€æµ‹è¯•å’Œäº¤ä»˜ã€‚æŒç»­äº¤ä»˜ä¸ä¼šè‡ªåŠ¨éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒï¼ŒæŒç»­éƒ¨ç½²åˆ™ä¼šè‡ªåŠ¨å°†æ›´æ–°å‘å¸ƒåˆ°ç”Ÿäº§ç¯å¢ƒã€‚ ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æˆ‘ä»¬å°†ä»£ç æäº¤åˆ°è¿œç¨‹ä»“åº“åï¼Œè‡ªåŠ¨åŒ–æœåŠ¡ä¼šæ›¿æˆ‘ä»¬å®Œæˆæµ‹è¯•äº¤ä»˜å’Œéƒ¨ç½²çš„åŠŸèƒ½ã€‚ å¸¸ç”¨çš„CICDå·¥å…·åœ¨æœ¬æ–‡ä¸­æˆ‘å°†æ¼”ç¤ºä½¿ç”¨gitea actionså®ç°hexoçš„è‡ªåŠ¨éƒ¨ç½²åŠŸèƒ½ã€‚ æ­£ç‰‡å¼€å§‹æ­£å¦‚å…¶åï¼Œå…¶å®giteaå’Œgithub actionsçš„åŠŸèƒ½å‡ ä¹ä¸€è‡´ï¼Œå°±æ˜¯æ²¿ç”¨ä¸‹æ¥äº†è€Œå·²ã€‚åœ¨æˆ‘ä»¬çš„æ“ä½œè¿‡ç¨‹ä¸­ï¼Œä¸»è¦æœ‰ä¸‰æ­¥ï¼š  ä½¿ç”¨dockerå¯åŠ¨ä¸€ä¸ªact_runnerï¼Œä½œä¸ºactionçš„æœåŠ¡å™¨ é…ç½®deploy.ymlå®ç°æ¨é€æ—¶ï¼Œè‡ªåŠ¨éƒ¨ç½²åˆ°æœåŠ¡å™¨ ä½¿ç”¨nginxå±•ç¤ºéƒ¨ç½²åçš„é¡µé¢  å®‰è£…act_runneræ‰“å¼€giteaçš„å®˜æ–¹æ–‡æ¡£å¯ä»¥æŸ¥é˜…å…³äºact_runnerçš„é…ç½®ä¿¡æ¯ æ³¨å†Œrunneråœ¨è¿è¡ŒAct...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/8e6632a6/" title="Nginx URI åŒ¹é…å’Œä½ç½®é…ç½®"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-15</div><div class="info-item-2">Nginx URI åŒ¹é…å’Œä½ç½®é…ç½®</div></div><div class="info-2"><div class="info-item-1">locationé…ç½® åŒ¹é… URI ç±»å‹ï¼Œæœ‰å››ç§å‚æ•°å¯é€‰ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä¸å¸¦å‚æ•°ã€‚ å‘½ålocationï¼Œç”¨@æ¥æ ‡è¯†ï¼Œç±»ä¼¼äºå®šä¹‰gotoè¯­å¥å—ã€‚1234561. location =    # ç²¾å‡†åŒ¹é…2. location ^~   # å¸¦å‚å‰ç¼€åŒ¹é…3. location ~    # æ­£åˆ™åŒ¹é…ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰4. location ~*   # æ­£åˆ™åŒ¹é…ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰5. location /a   # æ™®é€šå‰ç¼€åŒ¹é…ï¼Œä¼˜å…ˆçº§ä½äºå¸¦å‚æ•°å‰ç¼€åŒ¹é…ã€‚6. location /    # ä»»ä½•æ²¡æœ‰åŒ¹é…æˆåŠŸçš„ï¼Œéƒ½ä¼šåŒ¹é…è¿™é‡Œå¤„ç†  </div></div></div></a><a class="pagination-related" href="/posts/ef8bc635/" title="Nginxï¼šé«˜æ€§èƒ½WebæœåŠ¡å™¨åŠä»£ç†"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-19</div><div class="info-item-2">Nginxï¼šé«˜æ€§èƒ½WebæœåŠ¡å™¨åŠä»£ç†</div></div><div class="info-2"><div class="info-item-1">Nginx åŸºæœ¬æ¦‚å¿µï¼š ä¸€ä¸ªé«˜æ€§èƒ½çš„httpå’Œåå‘ä»£ç†webæœåŠ¡å™¨ï¼Œèƒ½æ”¯æŒé«˜è´Ÿè½½ï¼Œæ•ˆç‡é«˜  æ­£å‘ä»£ç†é€šè¿‡ä»£ç†æœåŠ¡å™¨è®¿é—®æœåŠ¡å™¨ï¼Œä¾‹å¦‚æ­å»ºæ¢¯å­æ‰è®¿é—®www.google.comã€‚ï¼ˆå¯ä»¥éšè—å®¢æˆ·ç«¯çš„ä¿¡æ¯ï¼‰è¿™ä¸ªå†…å®¹å°±å«æ­£å‘ä»£ç†  åå‘ä»£ç†ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯å°±æ˜¯å®¢æˆ·ç«¯å¯¹ä»£ç†æ— æ„ŸçŸ¥ï¼Œåªæ˜¯é€šè¿‡ä»£ç†æœåŠ¡å™¨å»éšè—ç›®æ ‡æœåŠ¡å™¨çš„å…·ä½“ä¿¡æ¯ï¼Œåªæš´éœ²ä»£ç†æœåŠ¡å™¨çš„åœ°å€ï¼Œéšè—çœŸå®æœåŠ¡å™¨çš„åœ°å€ã€‚åå‘ä»£ç†åï¼Œå®¢æˆ·ç«¯æ— æ³•çŸ¥é“æœåŠ¡å™¨çš„å…·ä½“ä½ç½®ã€‚  è´Ÿè½½å‡è¡¡     é»˜è®¤æƒ…å†µä¸‹ï¼Œæ˜¯ä¸€ä¸ªæœåŠ¡å™¨ï¼Œå‰åè¿é”ç›¸å…³ã€‚å°†åŸå…ˆé›†ä¸­åˆ°å•ä¸ªæœåŠ¡å™¨ä¸Šçš„æƒ…å†µæ”¹ä¸ºè¯·æ±‚åˆ†å‘åˆ°å¤šä¸ªæœåŠ¡å™¨ä¸Šã€‚    - åŠ¨é™åˆ†ç¦»å®é™…ä¸Šå°±æ˜¯å‰åç«¯åˆ†ç¦»ï¼Œnginxå¯ä»¥ç›´æ¥æ”¾å‰ç«¯çš„é™æ€èµ„æºï¼Œè€Œåç«¯å•ç‹¬éƒ¨ç½²ã€‚2. å®‰è£…ï¼Œé…ç½®  å…ˆå®‰è£…ä¾èµ–é¡¹(ä»¥centos7.8ä¸ºä¾‹ï¼‰123456789yum updateyum -y install make zlib zlib-devel gcc-c++ libtool openssl openssl-devel pcre pcre-devel#ä¸‹è½½ç¨³å®šç‰ˆå®‰è£…åŒ…wget...</div></div></div></a><a class="pagination-related" href="/posts/f1d3065d/" title="SSLè¯ä¹¦é…ç½®ã€è‡ªåŠ¨éƒ¨ç½²å’ŒNginxé›†æˆ"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-24</div><div class="info-item-2">SSLè¯ä¹¦é…ç½®ã€è‡ªåŠ¨éƒ¨ç½²å’ŒNginxé›†æˆ</div></div><div class="info-2"><div class="info-item-1">å…³äºå¦‚ä½•é…ç½®sslè¯ä¹¦å’Œè‡ªåŠ¨è£…é…ï¼Œå¹¶ä¸”éƒ¨ç½²åˆ°nginxçš„æœåŠ¡å™¨ä¸Šã€‚  é¦–å…ˆåœ¨freessl.cnéƒ¨ç½²ä¸€ä¸ªsslè¯ä¹¦ï¼Œå¯ä»¥æ˜¯æ³›åŸŸåçš„ã€‚ä»–åªæœ‰ä¸€ä¸ªæœˆã€‚æ­é…ä¸Šacmeå°±å¯ä»¥æ°¸ä¹…éƒ¨ç½²äº†ã€‚ å…·ä½“æ­¥éª¤å¦‚ä¸‹å…ˆè·å¾—sslæ³›åŸŸåè¯ä¹¦ã€‚ ç„¶åå®‰è£…acmeå®Œæˆè‡ªåŠ¨åŒ–éƒ¨ç½²ã€‚  å®‰è£…ä½¿ç”¨ä¸‹é¢è¿™ä¸ªå‘½ä»¤ï¼š 1curl https://get.acme.sh | sh -s email=my@example.com  å¯ä»¥æ ¹æ®ä¸Šé¢è¿™ä¸ªæ¨¡æ¿è¿›è¡Œä¿®æ”¹ã€‚æœ€åå°±ç®—éƒ¨ç½²å®Œæˆï¼Œå¯ä»¥æ­£å¸¸æµè§ˆä½ çš„ç½‘ç«™äº†.å®‰è£…å®Œæˆåï¼Œå°±æ ¹æ®freesslç»™ä½ çš„å‘½ä»¤ï¼Œç›´æ¥å¤åˆ¶åˆ°ä½ çš„æœåŠ¡å™¨æ‰§è¡Œï¼Œç„¶åå°±åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…å¥½è‡ªåŠ¨æ›´æ–°çš„è¯ä¹¦äº†ã€‚ä½†æ˜¯æ­¤æ—¶çš„è¯ä¹¦ä»»ç„¶æ²¡æœ‰éƒ¨ç½²åˆ°åŸŸåä¸Šï¼Œä»ç„¶éœ€è¦æ“ä½œ  éƒ¨ç½²å¥½åï¼Œè¯·è®°ä½ä½ çš„è¯ä¹¦å®‰è£…çš„åœ°å€ï¼Œè¿™ä¸ªä¹‹åéƒ¨ç½²åˆ°nginxä¸Šéœ€è¦ä½¿ç”¨ã€‚ nginxéƒ¨ç½²sslè¯ä¹¦æœ€å¥½çš„åšæ³•ä¸æ˜¯ç›´æ¥ä¿®æ”¹nginx.conf æ–‡ä»¶ï¼Œè€Œæ˜¯åœ¨conf.d...</div></div></div></a><a class="pagination-related" href="/posts/3e159b7d/" title="Ubuntuä¸Šè½»æ¾å®‰è£…Nginx"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-15</div><div class="info-item-2">Ubuntuä¸Šè½»æ¾å®‰è£…Nginx</div></div><div class="info-2"><div class="info-item-1">åœ¨ubuntuä¸‹æŒ‰ç…§nginxï¼Œåªéœ€è¦ä½¿ç”¨ç®€å•çš„å‘½ä»¤ 1apt install nginx  nginxçš„é…ç½®ç›®å½•éƒ½åœ¨/etc/nginxä¸‹ã€‚ ä¸»è¦çš„ Nginx é…ç½®æ–‡ä»¶æ˜¯/etc/nginx/nginx.confã€‚  </div></div></div></a><a class="pagination-related" href="/posts/bfeba94/" title="nginx éƒ¨ç½²å‰åç«¯é”™è¯¯è®°å½•"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-28</div><div class="info-item-2">nginx éƒ¨ç½²å‰åç«¯é”™è¯¯è®°å½•</div></div><div class="info-2"><div class="info-item-1">è®°å½•ä¸¤ä¸ªé”™è¯¯1åœ¨æˆ‘éƒ¨ç½²äº†ä¸€ä¸ªå‰ç«¯é¡µé¢åˆ°æœåŠ¡å™¨ä¸Šçš„nginxåï¼Œæˆ‘è®¿é—®ä»–æŠ¥é”™403.æ˜¾ç¤ºæ²¡æœ‰æƒé™ã€‚åæ¥å‘ç°403çš„ä¸€ä¸ªå¯èƒ½åŸå› æ˜¯å› ä¸ºnginxæ²¡æœ‰æƒé™è®¿é—®åˆ°&#x2F;rootä¸­çš„å†…å®¹ã€‚å› ä¸ºæˆ‘æŠŠvueæ‰“åŒ…çš„é¡µé¢ç›´æ¥æ”¾åˆ°äº†rootç›®å½•ä¸‹ã€‚å› æ­¤æŠ¥é”™ï¼Œåªè¦å°†è¿™ä¸ªdistæ–‡ä»¶æ”¾åˆ°å…¶ä»–ä½ç½®å³å¯æ­£å¸¸è®¿é—®äº† 2vueéƒ¨ç½²äº†è·¯ç”±çš„è¯ï¼Œå†éƒ¨ç½²åˆ°nginxä¸Šéœ€è¦ä¸ºvueçš„è·¯ç”±ä¸“é—¨é…ç½® 12345location / &#123;               root html/dist;               index index.html;               try_files $uri $uri/ /index.html;#è§£å†³é¡µé¢åˆ·æ–°       &#125; åŒæ—¶å› ä¸ºvueçš„ä»£ç†æœåŠ¡å™¨åªåœ¨è¿è¡Œæ—¶æ‰æœ‰ç”¨ã€‚å› æ­¤éœ€è¦å†nginxéƒ¨ç½²ä»£ç†æœåŠ¡å™¨ã€‚æˆ–è€…å†åç«¯è§£å†³è·¨åŸŸé—®é¢˜ã€‚è¿™é‡Œä»‹ç»å†nginxè§£å†³ä»£ç†çš„æ–¹æ³•ã€‚ 123456789101112location  /api/ &#123;            # å•ä¸ªæœåŠ¡            proxy_pass...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://image.zfxt.top/hexo-blog/avator.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">å°è´ºåŒå­¦</div><div class="author-info-description">åˆ†äº«çŸ¥è¯†ï¼Œå‹¤åšç¬”è®°</div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">265</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">100</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">16</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/zfx-t"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">å…è®¸ä¸€åˆ‡äº‹ç‰©çš„å­˜åœ¨ï¼Œéƒ½æ˜¯æœ‰æ„ä¹‰çš„ã€‚</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8docker%E9%83%A8%E7%BD%B2nginx"><span class="toc-number">1.</span> <span class="toc-text">ä½¿ç”¨dockeréƒ¨ç½²nginx</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E7%9B%AE%E5%BD%95%E6%98%A0%E5%B0%84"><span class="toc-number">1.1.</span> <span class="toc-text">æœ¬åœ°ç›®å½•æ˜ å°„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E4%B8%93%E9%97%A8%E7%9A%84nginx%E7%BD%91%E7%BB%9C"><span class="toc-number">1.2.</span> <span class="toc-text">é…ç½®ä¸“é—¨çš„nginxç½‘ç»œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E4%B8%80%E7%9B%B4%E9%87%8D%E5%90%AF"><span class="toc-number">1.3.</span> <span class="toc-text">è®¾ç½®ä¸€ç›´é‡å¯</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%BAnginx%E9%85%8D%E7%BD%AEssl%E8%AF%81%E4%B9%A6"><span class="toc-number">2.</span> <span class="toc-text">ä¸ºnginxé…ç½®sslè¯ä¹¦</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%9F%9F%E5%90%8D"><span class="toc-number">2.1.</span> <span class="toc-text">æ·»åŠ åŸŸå</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%86%E8%AF%81%E4%B9%A6%E9%83%A8%E7%BD%B2%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">2.2.</span> <span class="toc-text">å°†è¯ä¹¦éƒ¨ç½²åˆ°æœåŠ¡å™¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BAnginx%E4%BD%BF%E7%94%A8%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">2.3.</span> <span class="toc-text">ä¸ºnginxä½¿ç”¨é…ç½®æ–‡ä»¶</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#nginx%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E"><span class="toc-number">3.</span> <span class="toc-text">nginxä½¿ç”¨è¯´æ˜</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Nginx%E7%9A%84location%E8%AF%AD%E6%B3%95"><span class="toc-number">3.1.</span> <span class="toc-text">Nginxçš„locationè¯­æ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#alias%E4%B8%8Eroot%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">3.2.</span> <span class="toc-text">aliasä¸rootçš„åŒºåˆ«</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#proxy-pass%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">3.3.</span> <span class="toc-text">proxy_passçš„ä½¿ç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#permanent-%E5%92%8C-redirect%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">3.4.</span> <span class="toc-text">permanent å’Œ redirectå…³é”®å­—çš„åŒºåˆ«</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/9493ce59/" title="æ–°å…¬å‘Š"><img src="https://image.zfxt.top/hexo-blog/æ–°å…¬å‘Š-2025-02-18-15-37-55.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æ–°å…¬å‘Š"/></a><div class="content"><a class="title" href="/posts/9493ce59/" title="æ–°å…¬å‘Š">æ–°å…¬å‘Š</a><time datetime="2025-02-18T07:30:18.000Z" title="å‘è¡¨äº 2025-02-18 15:30:18">2025-02-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/16639286/" title="docker,nginx,sslæœ€ä½³å®è·µ"><img src="https://image.zfxt.top/hexo-blog/docker-nginx-sslæœ€ä½³å®è·µ-2024-12-25-16-58-02.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="docker,nginx,sslæœ€ä½³å®è·µ"/></a><div class="content"><a class="title" href="/posts/16639286/" title="docker,nginx,sslæœ€ä½³å®è·µ">docker,nginx,sslæœ€ä½³å®è·µ</a><time datetime="2024-12-25T06:12:29.000Z" title="å‘è¡¨äº 2024-12-25 14:12:29">2024-12-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/f5d3f52f/" title="ä½¿ç”¨gitea actionå®ç°CICD"><img src="https://image.zfxt.top/hexo-blog/ä½¿ç”¨gitea-actionå®ç°CICD-2024-12-25-14-13-21.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ä½¿ç”¨gitea actionå®ç°CICD"/></a><div class="content"><a class="title" href="/posts/f5d3f52f/" title="ä½¿ç”¨gitea actionå®ç°CICD">ä½¿ç”¨gitea actionå®ç°CICD</a><time datetime="2024-12-25T05:13:23.000Z" title="å‘è¡¨äº 2024-12-25 13:13:23">2024-12-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/9c04f269/" title="dockeræœåŠ¡å™¨ç™½å«–"><img src="https://image.zfxt.top/hexo-blog/dockeræœåŠ¡å™¨ç™½å«–-2024-12-25-12-11-40.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="dockeræœåŠ¡å™¨ç™½å«–"/></a><div class="content"><a class="title" href="/posts/9c04f269/" title="dockeræœåŠ¡å™¨ç™½å«–">dockeræœåŠ¡å™¨ç™½å«–</a><time datetime="2024-12-25T03:47:51.000Z" title="å‘è¡¨äº 2024-12-25 11:47:51">2024-12-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/dd9695f2/" title="ubuntuä½¿ç”¨sshå¯†é’¥ç™»å½•"><img src="https://image.zfxt.top/hexo-blog/ubuntuä½¿ç”¨sshå¯†é’¥ç™»å½•-2024-12-25-11-43-25.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ubuntuä½¿ç”¨sshå¯†é’¥ç™»å½•"/></a><div class="content"><a class="title" href="/posts/dd9695f2/" title="ubuntuä½¿ç”¨sshå¯†é’¥ç™»å½•">ubuntuä½¿ç”¨sshå¯†é’¥ç™»å½•</a><time datetime="2024-12-25T03:17:36.000Z" title="å‘è¡¨äº 2024-12-25 11:17:36">2024-12-25</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://image.zfxt.top/hexo-blog/docker-nginx-sslæœ€ä½³å®è·µ-2024-12-25-16-58-02.png);"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025 By å°è´ºåŒå­¦</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">æœ¬ç½‘ç«™ç”± <a target="_blank" rel="noopener" href="https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral"><img src="https://cdn.jsdelivr.net/gh/xingjiahui/CDN/åˆæ‹äº‘_logo.png" align="absmiddle" width="59px" height="30px" /></a> æä¾›CDNåŠ é€Ÿ/äº‘å­˜å‚¨æœåŠ¡<br> <a href="https://beian.miit.gov.cn/" target="_blank">æ¹˜ICPå¤‡2023014266å·-1</a><br><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=43030302000164" target="_blank"><img src="https://www.beian.gov.cn/img/ghs.png"  >æ¹˜å…¬ç½‘å®‰å¤‡ 43030302000164å·</a><br></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="å‰å¾€è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="https://unpkg.com/hexo-theme-butterfly/source/js/utils.js"></script><script src="https://unpkg.com/hexo-theme-butterfly/source/js/main.js"></script><script src="https://unpkg.com/hexo-theme-butterfly/source/js/tw_cn.js"></script><script src="https://unpkg.com/@fancyapps/ui/dist/fancybox/fancybox.umd.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.isShuoshuo
  const option = null

  const commentCount = n => {
    const isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
    if (isCommentCount) {
      isCommentCount.textContent= n
    }
  }

  const initGitalk = (el, path) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyGitalk = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const gitalk = new Gitalk({
      clientID: 'dead8e226547393b381f',
      clientSecret: '3d558abe1e03abc025fbd66a3dab37f918fa08e0',
      repo: 'blog-comment',
      owner: 'zfx-t',
      admin: ['zfx-t'],
      updateCountCallback: commentCount,
      ...option,
      id: isShuoshuo ? path : (option && option.id) || '64fdcab35839d0f6c3126f6b7775d8ba'
    })

    gitalk.render('gitalk-container')
  }

  const loadGitalk = async(el, path) => {
    if (typeof Gitalk === 'function') initGitalk(el, path)
    else {
      await btf.getCSS('https://unpkg.com/gitalk/dist/gitalk.css')
      await btf.getScript('https://unpkg.com/gitalk/dist/gitalk.min.js')
      initGitalk(el, path)
    }
  }

  if (isShuoshuo) {
    'Gitalk' === 'Gitalk'
      ? window.shuoshuoComment = { loadComment: loadGitalk }
      : window.loadOtherComment = loadGitalk
    return
  }

  if ('Gitalk' === 'Gitalk' || !false) {
    if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
    else loadGitalk()
  } else {
    window.loadOtherComment = loadGitalk
  }
})()</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://unpkg.com/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="https://unpkg.com/hexo-theme-butterfly/source/js/search/local-search.js"></script></div></div></body></html>